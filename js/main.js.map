{"version":3,"file":"main.js","mappings":"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","sources":["webpack://gulp-builder/./src/js/main.js"],"sourcesContent":["// массивы с месяцами\nconst months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October',\n  'November', 'December'\n];\nconst monthsRu = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь',\n  'Ноябрь', 'Декабрь'\n];\n\n// склонение числительных\nconst declOfNum = (number, titles) => {\n  let cases = [2, 0, 1, 1, 1, 2];\n  return titles[ (number%100>4 && number%100<20)? 2 : cases[(number%10<5)?number%10:5] ];\n}\n\n// глобальные константы для API, определения года и месяца\nconst API_KEY = \"a40e2fba-71cb-4ddb-8e49-5e753ed3db24\";\nconst currentYear = new Date().getFullYear();\nconst currentMonth = new Date().getMonth();\nconst currentMonthText = months[currentMonth].toUpperCase();\nconst currentMonthRu = monthsRu[currentMonth];\n\n// определение query-параметра\nconst params = new Proxy(new URLSearchParams(window.location.search), {\n  get: (searchParams, prop) => searchParams.get(prop),\n});\n\nlet queryParam = params.page;\n\nif (!queryParam) {\n  queryParam = 1;\n  history.pushState(null, null, '?page=1');\n}\n\n// переменные для элементов страницы\nconst appListEl = document.querySelector('.app__list');\nconst yearEl = document.querySelector('.year');\nconst monthEl = document.querySelector('.month');\nconst paginationsEl = document.querySelectorAll('.app__pagination');\nconst errorEl = document.querySelector('.app__error');\nconst loadingEl = document.querySelector('.app__loading');\n\n// устанавливаем текущий месяц и год\nyearEl.textContent = currentYear;\nmonthEl.textContent = currentMonthRu;\n\nconst initApp = (page = 1) => {\n  const url = `https://kinopoiskapiunofficial.tech/api/v2.1/films/releases?year=${currentYear}&month=${currentMonthText}&page=${page}`;\n\n  fetch(url, {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"X-API-KEY\": API_KEY,\n    }\n  })\n  .then((response) => response.json())\n  .then((data) => {\n    errorEl.style.display = 'none';\n    loadingEl.style.display = 'none';\n\n\n    // считаем кол-во страниц и выводим в пагинацию\n\n    const total = data.total;\n    const pages = Math.ceil(total / 10);\n\n    for (let i = pages; i >= 1; i--) {\n      paginationsEl.forEach(el => {\n        el.insertAdjacentHTML('afterbegin', `\n          <li class=\"app__pagination-item\">\n            <a href=\"?page=${i}\" class=\"app__pagination-link ${i == queryParam ? 'app__pagination-link--current' : ''}\">${i}</a>\n          </li>\n        `);\n      });\n    }\n\n    return data;\n  })\n  .then((data) => {\n    for (item of data.releases) {\n      const options = {\n        month: 'long',\n        day: 'numeric'\n      };\n\n      let date = new Date(item.releaseDate).toLocaleDateString('ru-RU', options);\n\n      let rating = item.rating ? item.rating.toFixed(1) : 'Недостаточно голосов';\n\n      let duration = `${item.duration} ${declOfNum(item.duration, ['минута', 'минуты', 'минут'])}`;\n\n      let to = item.genres.map(item => Object.values(item)[0]);\n\n      let genres = to.toString().replace(',', ', ');\n\n      appListEl.insertAdjacentHTML('afterbegin', `\n        <li class=\"app__list-item\">\n          <article class=\"app__card movie-card\">\n            <a href=\"https://www.kinopoisk.ru/film/${item.filmId}\" target=\"_blank\" class=\"movie-card__link\">\n              <div class=\"movie-card__image-wrapper\">\n                <img\n                  src=\"${item.posterUrlPreview}\"\n                  alt=\"${!item.nameRu ? item.nameEn : item.nameRu}\" loading=\"lazy\" class=\"movie-card__image\">\n                <div class=\"movie-card__hover\">\n                  <div class=\"movie-card__rating ${item.rating == null ? 'movie-card__rating--null' : ''}\">${rating}</div>\n                  <div class=\"movie-card__genres\">${genres}</div>\n                  <div class=\"movie-card__duration ${item.duration == 0 ? 'movie-card__duration--hidden' : ''}\">${duration}</div>\n                </div>\n              </div>\n              <h2 class=\"movie-card__title\">${!item.nameRu ? item.nameEn : item.nameRu}</h2>\n              <div class=\"movie-card__date\">${date}</div>\n            </a>\n          </article>\n        </li>\n      `);\n    }\n  })\n  .catch(() => {\n    errorEl.style.display = 'block';\n    loadingEl.style.display = 'none';\n  });\n};\n\ninitApp(queryParam);\n"],"names":["months","monthsRu","declOfNum","number","titles","cases","API_KEY","currentYear","Date","getFullYear","currentMonth","getMonth","currentMonthText","toUpperCase","currentMonthRu","params","Proxy","URLSearchParams","window","location","search","get","searchParams","prop","queryParam","page","history","pushState","appListEl","document","querySelector","yearEl","monthEl","paginationsEl","querySelectorAll","errorEl","loadingEl","textContent","initApp","url","fetch","headers","then","response","json","data","style","display","total","pages","Math","ceil","i","forEach","el","insertAdjacentHTML","item","releases","options","month","day","date","releaseDate","toLocaleDateString","rating","toFixed","duration","to","genres","map","Object","values","toString","replace","filmId","posterUrlPreview","nameRu","nameEn","catch"],"sourceRoot":""}